<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Simon Vandekar">

<title>Class 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="class2_files/libs/clipboard/clipboard.min.js"></script>
<script src="class2_files/libs/quarto-html/quarto.js"></script>
<script src="class2_files/libs/quarto-html/popper.min.js"></script>
<script src="class2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="class2_files/libs/quarto-html/anchor.min.js"></script>
<link href="class2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="class2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="class2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="class2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="class2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#objectives" id="toc-objectives" class="nav-link active" data-scroll-target="#objectives">Objectives:</a></li>
  <li><a href="#why-probability" id="toc-why-probability" class="nav-link" data-scroll-target="#why-probability">Why probability</a></li>
  <li><a href="#properties-of-probability" id="toc-properties-of-probability" class="nav-link" data-scroll-target="#properties-of-probability">Properties of probability</a>
  <ul class="collapse">
  <li><a href="#coin-flips-and-diagnoses" id="toc-coin-flips-and-diagnoses" class="nav-link" data-scroll-target="#coin-flips-and-diagnoses">Coin flips and diagnoses</a></li>
  <li><a href="#random-variables-and-probability-notation" id="toc-random-variables-and-probability-notation" class="nav-link" data-scroll-target="#random-variables-and-probability-notation">Random variables and probability notation</a></li>
  <li><a href="#probability-axioms" id="toc-probability-axioms" class="nav-link" data-scroll-target="#probability-axioms">Probability axioms</a></li>
  <li><a href="#wordle-using-the-multinomial-distribution" id="toc-wordle-using-the-multinomial-distribution" class="nav-link" data-scroll-target="#wordle-using-the-multinomial-distribution">Wordle using the multinomial distribution</a></li>
  <li><a href="#probability-density-function-pdf" id="toc-probability-density-function-pdf" class="nav-link" data-scroll-target="#probability-density-function-pdf">Probability density function (PDF)</a></li>
  <li><a href="#cumulative-distribution-function-cdf" id="toc-cumulative-distribution-function-cdf" class="nav-link" data-scroll-target="#cumulative-distribution-function-cdf">Cumulative Distribution Function (CDF)</a></li>
  <li><a href="#mean" id="toc-mean" class="nav-link" data-scroll-target="#mean">Mean</a></li>
  <li><a href="#variance" id="toc-variance" class="nav-link" data-scroll-target="#variance">Variance</a></li>
  <li><a href="#jointly-distributed-random-variables" id="toc-jointly-distributed-random-variables" class="nav-link" data-scroll-target="#jointly-distributed-random-variables">Jointly distributed random variables</a></li>
  </ul></li>
  <li><a href="#connecting-data-and-probability-with-a-random-sample" id="toc-connecting-data-and-probability-with-a-random-sample" class="nav-link" data-scroll-target="#connecting-data-and-probability-with-a-random-sample">Connecting data and probability with a random sample</a>
  <ul class="collapse">
  <li><a href="#statistics-is-a-way-to-learn-about-the-world-from-a-data-set" id="toc-statistics-is-a-way-to-learn-about-the-world-from-a-data-set" class="nav-link" data-scroll-target="#statistics-is-a-way-to-learn-about-the-world-from-a-data-set">Statistics is a way to learn about the world from a data set</a></li>
  <li><a href="#a-random-sample-for-the-alcohol-question" id="toc-a-random-sample-for-the-alcohol-question" class="nav-link" data-scroll-target="#a-random-sample-for-the-alcohol-question">A random sample for the alcohol question</a></li>
  </ul></li>
  <li><a href="#estimates" id="toc-estimates" class="nav-link" data-scroll-target="#estimates">Estimates</a></li>
  <li><a href="#estimators" id="toc-estimators" class="nav-link" data-scroll-target="#estimators">Estimators</a></li>
  <li><a href="#bias-variance-and-mse-of-the-proportion-estimator" id="toc-bias-variance-and-mse-of-the-proportion-estimator" class="nav-link" data-scroll-target="#bias-variance-and-mse-of-the-proportion-estimator">Bias, variance, and MSE of the proportion estimator</a></li>
  <li><a href="#nsduh-example-of-bias-variance-and-mse" id="toc-nsduh-example-of-bias-variance-and-mse" class="nav-link" data-scroll-target="#nsduh-example-of-bias-variance-and-mse">NSDUH: example of bias, variance, and MSE</a></li>
  <li><a href="#parameters-estimators-estimates" id="toc-parameters-estimators-estimates" class="nav-link" data-scroll-target="#parameters-estimators-estimates">Parameters, Estimators, Estimates</a></li>
  <li><a href="#practice" id="toc-practice" class="nav-link" data-scroll-target="#practice">Practice</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Class 2</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Simon Vandekar </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">Objectives:</h2>
<ol type="1">
<li>Learn some basic concepts about probabilities</li>
<li>Learn to use probability to think about data</li>
</ol>
</section>
<section id="why-probability" class="level2">
<h2 class="anchored" data-anchor-id="why-probability">Why probability</h2>
<ul>
<li>Probability is the language of statistics.</li>
<li>It is how we can understand data and evaluate the quantitative methods we use.</li>
</ul>
</section>
<section id="properties-of-probability" class="level2">
<h2 class="anchored" data-anchor-id="properties-of-probability">Properties of probability</h2>
<p>Examples Coin flip Dice roll Dependence/Independence Continuous example Expected values/Averages CDF, PDF</p>
<section id="coin-flips-and-diagnoses" class="level3">
<h3 class="anchored" data-anchor-id="coin-flips-and-diagnoses">Coin flips and diagnoses</h3>
<ul>
<li>Something that takes only two values can be described with a Bernoulli random variable.
<ul>
<li>Coin flip</li>
<li>Diagnosis: schizophrenia, COVID+ or not</li>
</ul></li>
</ul>
<table class="table">
<thead>
<tr class="header">
<th>Bernoulli values <span class="math inline">x</span></th>
<th>probabilities</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0 (tails)</td>
<td>1-p</td>
</tr>
<tr class="even">
<td>1 (heads)</td>
<td>p</td>
</tr>
</tbody>
</table>
<ul>
<li>What is a sensible value for <span class="math inline">p</span> for the different Bernoulli variables above?</li>
</ul>
</section>
<section id="random-variables-and-probability-notation" class="level3">
<h3 class="anchored" data-anchor-id="random-variables-and-probability-notation">Random variables and probability notation</h3>
<ul>
<li>For <span class="math inline">X\sim \text{Be}(\pi)</span>: X is distributed as (<span class="math inline">\sim</span> means “is distributed as”) <a href="https://en.wikipedia.org/wiki/Bernoulli_distribution">Bernoulli</a>, with parameter <span class="math inline">p \in (0,1)</span>, e.g.&nbsp;<span class="math inline">p=0.25</span>.</li>
<li>Blackboard or capital P is probability, <span class="math inline">\mathbb{P}(X=x)</span>, means the probability the random variable <span class="math inline">X</span> is equal to the nonrandom value <span class="math inline">x</span>.</li>
<li><span class="math inline">\mathbb{P}(X = x) = p^x(1-p)^{(1-x)}</span>. That is the probability mass function (PMF) of a Bernoulli random variable</li>
<li>Common notation is <span class="math inline">f_X(x)</span> is the PMF of the random variable <span class="math inline">X</span>. In this case <span class="math inline">f_X(x):=p^x(1-p)^{(1-x)}</span>.</li>
<li><span class="math inline">:=</span> notation means “is defined by.”</li>
<li>A random variable does not have a value in itself… We don’t usually talk about <span class="math inline">X=0.5</span>, but <span class="math inline">\mathbb{P}(X=0.5)</span>.</li>
</ul>
</section>
<section id="probability-axioms" class="level3">
<h3 class="anchored" data-anchor-id="probability-axioms">Probability axioms</h3>
<p>We have an intuitive understanding of the basic axioms of probability.</p>
<ul>
<li>An event <span class="math inline">E</span> is something that can occur, e.g.&nbsp;head or tails.</li>
<li><span class="math inline">F</span> is the collection of all events e.g.&nbsp;<span class="math inline">F = \{ \{0\}, \{1\} \}</span>.</li>
<li>Let <span class="math inline">\Omega = {0,1}</span> be union of all possible events</li>
</ul>
<p>The (Kolmogorov) axioms are</p>
<ol type="1">
<li><span class="math inline">\mathbb{P}(X\in E) \ge 0</span> – probability is positive.</li>
<li><span class="math inline">\mathbb{P}(X\in \Omega) = 1</span> – probabilities sum to 1 (a person has COVID, or they don’t).</li>
<li>For disjoint sets <span class="math inline">E_1 \cap E_2 = \varnothing</span>, <span class="math inline">\mathbb{P}(E_1 \cup E_2) = \mathbb{P}(E_1) + \mathbb{P}(E_2)</span>.</li>
</ol>
<p>All the other properties of probability can be derived using these three axioms.</p>
</section>
<section id="wordle-using-the-multinomial-distribution" class="level3">
<h3 class="anchored" data-anchor-id="wordle-using-the-multinomial-distribution">Wordle using the multinomial distribution</h3>
<ul>
<li>Multinomial can be used for distributions with multiple categories.
<ul>
<li>Die rolls, Wordle number of guesses</li>
<li>Likert scales (e.g.&nbsp;<a href="https://en.wikipedia.org/wiki/Positive_and_Negative_Syndrome_Scale">PANSS</a> in schizophrenia), Tanner staging (puberty; 1-5), Cancer staging (0-4)</li>
</ul></li>
<li>The probability of getting the Wordle in a certain number of guesses.</li>
<li>Also 6 (or one more) possible values.</li>
<li>Same family of distribution as the die, except with different <em>parameters</em></li>
</ul>
<table class="table">
<thead>
<tr class="header">
<th><span class="math inline">Y=</span>Number of tries</th>
<th style="text-align: center;"><span class="math inline">\mathbb{P}(Y)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td>2</td>
<td style="text-align: center;">0.03</td>
</tr>
<tr class="odd">
<td>3</td>
<td style="text-align: center;">0.28</td>
</tr>
<tr class="even">
<td>4</td>
<td style="text-align: center;">0.40</td>
</tr>
<tr class="odd">
<td>5</td>
<td style="text-align: center;">0.18</td>
</tr>
<tr class="even">
<td>6</td>
<td style="text-align: center;">0.11</td>
</tr>
<tr class="odd">
<td>7</td>
<td style="text-align: center;">??</td>
</tr>
</tbody>
</table>
<center>
<div id="id" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/wordle.jpg" class="class img-fluid figure-img" style="width:25.0%"></p>
<p></p><figcaption class="figure-caption">Wordle results</figcaption><p></p>
</figure>
</div>
</center></section>
<section id="probability-density-function-pdf" class="level3">
<h3 class="anchored" data-anchor-id="probability-density-function-pdf">Probability density function (PDF)</h3>
<ul>
<li>The probability density function <span class="math inline">f_X(x)</span> for a random variable <span class="math inline">X</span> can be thought of as <span class="math inline">\mathbb{P}(X=x)</span>.</li>
<li>It is called the probability mass function (PMF) for discrete random variables.</li>
</ul>
<p>The PDF (probability density function) is the derivative of the CDF and often denoted with a lower case letter <span class="math inline">f(x)</span>. For discrete random variables the PDF is call the PMF (probability mass function).</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="class2_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="288"></p>
<p></p><figcaption class="figure-caption">Density functions.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<section id="wordle-pdf" class="level4">
<h4 class="anchored" data-anchor-id="wordle-pdf">Wordle PDF</h4>
<ul>
<li>Let’s draw the PDF for the Wordle distribution</li>
</ul>
</section>
<section id="body-mass-index" class="level4">
<h4 class="anchored" data-anchor-id="body-mass-index">Body mass index</h4>
<p>From the <code>insurance</code> dataset</p>
<ul>
<li><p>BMI is a continuous random variable, <span class="math display">
\mathrm{BMI} = \mathrm{weight}/\mathrm{height}^2
</span></p></li>
<li><p>Here’s a plot from the insurance dataset.</p></li>
<li><p>It looks approximately normally distributed (not quite).</p></li>
<li><p>I’ve drawn the normal density on top</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RESI)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'clubSandwich':
  method    from    
  bread.mlm sandwich</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>lims <span class="ot">=</span> <span class="fu">hist</span>(insurance<span class="sc">$</span>bmi, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">08</span>), <span class="at">main=</span><span class="st">'BMI Histogram'</span>, <span class="at">xlab=</span><span class="st">'BMI'</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="fu">min</span>(lims<span class="sc">$</span>mids), <span class="fu">max</span>(lims<span class="sc">$</span>mids), <span class="at">length.out=</span><span class="dv">100</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="fu">mean</span>(insurance<span class="sc">$</span>bmi),<span class="at">sd=</span><span class="fu">sd</span>(insurance<span class="sc">$</span>bmi)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="class2_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="288"></p>
</div>
</div>
<ul>
<li><p>The normal distribution is <span class="math display">
f_X(x) = \frac{1}{2\pi \sigma^2} e^{-\frac{1}{2\sigma^2} (x - \mu)^2}
</span></p></li>
<li><p>In our dataset the mean is <span class="math inline">\hat \mu =</span> 30.66, and the standard deviation is <span class="math inline">\hat\sigma =</span> 6.1.</p></li>
<li><p>We can use <span class="math inline">f_X(x)</span> to compute probabilities that a person’s BMI lies in a particular range.</p>
<ul>
<li>Probability less than or equal to “healthy” – <span class="math inline">\mathbb{P}(X \le x) = \int^{25}_0 f_X(x)dx</span></li>
<li>Probability in “healthy range” – <span class="math inline">\mathbb{P}(X \le x) = \int^{25}_{18} f_X(x)dx</span></li>
</ul></li>
</ul>
</section>
</section>
<section id="cumulative-distribution-function-cdf" class="level3">
<h3 class="anchored" data-anchor-id="cumulative-distribution-function-cdf">Cumulative Distribution Function (CDF)</h3>
<p>The cumulative distribution function (CDF), <span class="math inline">F_X(x)</span>, for a random variable <span class="math inline">X</span> is a function that satisfies <span class="math display">
F_X(x) = \mathbb{P}(X \le x).
</span> They are usually functions of parameters. Here are some examples.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="class2_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="768"></p>
<p></p><figcaption class="figure-caption">Some distribution functions.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<ul>
<li>What are some features that you recognize about these distribution functions?</li>
</ul>
<p>For discrete random variables the derivative of the CDF does not exist because it is a step function, but the probability mass function is the amount the CDF jumps up at that location, heuristically we can define it as <span class="math display">
f(x) = F(x+\Delta x) - F(x),
</span> for an infinitesimal value <span class="math inline">\Delta x</span>.</p>
<section id="bmi-example-continued" class="level4">
<h4 class="anchored" data-anchor-id="bmi-example-continued">BMI example continued</h4>
<ul>
<li>CDF can be thought of as a percentile function – you plug in a BMI value and get out the probability that someone in the population is less than that value.</li>
<li>Use this <a href="https://dqydj.com/bmi-percentile-calculator-united-states/">link</a> to compute the probabilities of being
<ul>
<li>Underweight</li>
<li>Healthy weight</li>
<li>Overweight</li>
<li>Obese</li>
</ul></li>
<li><strong>Hint:</strong> you’ll have to use some calculus rules to compute the probabilities.</li>
</ul>
</section>
<section id="wordle-cdf-example" class="level4">
<h4 class="anchored" data-anchor-id="wordle-cdf-example">Wordle CDF example</h4>
<ul>
<li>Let’s compare the CDFs of my score and my partner’s score.</li>
</ul>
<table class="table">
<colgroup>
<col style="width: 36%">
<col style="width: 31%">
<col style="width: 31%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">y=</span>Number of tries</th>
<th style="text-align: center;"><span class="math inline">P(Y=y|\text{Simon})</span></th>
<th style="text-align: center;"><span class="math inline">P(Y=y|\text{Lillie})</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td>2</td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;">0.05</td>
</tr>
<tr class="odd">
<td>3</td>
<td style="text-align: center;">0.28</td>
<td style="text-align: center;">0.24</td>
</tr>
<tr class="even">
<td>4</td>
<td style="text-align: center;">0.40</td>
<td style="text-align: center;">0.44</td>
</tr>
<tr class="odd">
<td>5</td>
<td style="text-align: center;">0.18</td>
<td style="text-align: center;">0.19</td>
</tr>
<tr class="even">
<td>6</td>
<td style="text-align: center;">0.11</td>
<td style="text-align: center;">0.08</td>
</tr>
</tbody>
</table>
<!-- <center> -->
<!-- ![Wordle results](figures/wordle.jpg){#id .class width=25%} -->
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>wordle1 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">17</span>, <span class="dv">25</span>, <span class="dv">11</span>, <span class="dv">7</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>wordle2 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">9</span>, <span class="dv">16</span>, <span class="dv">7</span>, <span class="dv">3</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>wordle1 <span class="ot">=</span> <span class="fu">cumsum</span>(wordle1<span class="sc">/</span><span class="fu">sum</span>(wordle1))</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>wordle2 <span class="ot">=</span> <span class="fu">cumsum</span>(wordle2<span class="sc">/</span><span class="fu">sum</span>(wordle2))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">7</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="fu">c</span>(<span class="dv">0</span>,wordle1, <span class="dv">1</span>), <span class="at">main=</span><span class="st">'Wordle CDFs'</span>, <span class="at">type=</span><span class="st">'s'</span>, <span class="at">ylab=</span><span class="st">'P(X&lt;=x)'</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x, <span class="fu">c</span>(<span class="dv">0</span>,wordle2, <span class="dv">1</span>), <span class="at">type=</span><span class="st">'s'</span>, <span class="at">col=</span><span class="st">'red'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="class2_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="288"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>main <span class="ot">=</span> <span class="fu">c</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>What is the interpretation of this graph?</li>
<li>Who is doing better (getting the word in fewer guesses)?</li>
</ul>
</section>
</section>
<section id="mean" class="level3">
<h3 class="anchored" data-anchor-id="mean">Mean</h3>
<ul>
<li>The mean might be a nicer way to compare our scores.</li>
</ul>
<p>The mean is the most common expected value <span class="math display">
\mathbb{E} X = \int_{\mathcal{X}} x p(x) dx = \sum_{x}x p(x).
</span></p>
<ul>
<li>The integral notation is in the sense of “real analysis” type integrals that can refer to sums or integrals. This is to emphasize that the definition is the same with continuous or discrete random variables.</li>
</ul>
<table class="table">
<colgroup>
<col style="width: 28%">
<col style="width: 24%">
<col style="width: 24%">
<col style="width: 24%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">y=</span>Number of tries</th>
<th style="text-align: center;"><span class="math inline">P(Y=y|\text{Simon})</span></th>
<th style="text-align: center;"><span class="math inline">P(Y=y|\text{Lillie})</span></th>
<th style="text-align: center;"><span class="math inline">y\times P(Y=y|\text{Lillie or Simon})</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td>2</td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td>3</td>
<td style="text-align: center;">0.28</td>
<td style="text-align: center;">0.24</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td>4</td>
<td style="text-align: center;">0.40</td>
<td style="text-align: center;">0.44</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td>5</td>
<td style="text-align: center;">0.18</td>
<td style="text-align: center;">0.19</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td>6</td>
<td style="text-align: center;">0.11</td>
<td style="text-align: center;">0.08</td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<ul>
<li><p><span class="math inline">\mathbb{E}X</span> is a nonrandom value, called a <em>parameter</em>.</p></li>
<li><p>A parameter is something that describes a feature of the distribution of a random variable.</p></li>
<li><p>For the Bernoulli distribution, <span class="math inline">p</span>.</p></li>
<li><p>For multinomial, it’s the vector of probabilities.</p></li>
<li><p>For the normal distribution <span class="math display">
\mathbb{E} X = \int_{-\inf}^\inf x \frac{1}{2\pi \sigma^2} e^{-\frac{1}{2\sigma^2} (x - \mu)^2} dx = \mu.
</span></p></li>
<li><p>Properties include</p>
<ul>
<li><span class="math inline">\mathbb{E}\{ aX + b Y\} = \{ a\mathbb{E}X + b \mathbb{E}Y\}</span>, for constant values <span class="math inline">a</span> and <span class="math inline">b</span>.</li>
</ul></li>
</ul>
</section>
<section id="variance" class="level3">
<h3 class="anchored" data-anchor-id="variance">Variance</h3>
<ul>
<li><p>Another common expectation is the variance <span class="math display">
\text{Var}(X) = \mathbb{E} (X - \E X)^2 = \E X^2 - (\E X)^2
</span></p></li>
<li><p>In words, it is the average squared distance of the random variable from its expected value.</p></li>
<li><p>It is a measure of the amount of spread of a random variable</p></li>
<li><p>For the normal distribution <span class="math display">
\mathrm{Var}( X ) = \int_{-\inf}^\inf (x-\mu)^2 \frac{1}{2\pi \sigma^2} e^{-\frac{1}{2\sigma^2} (x - \mu)^2} dx = \sigma^2.
</span></p></li>
<li><p>Properties</p>
<ul>
<li><span class="math inline">\mathrm{Var}(bX-a) = b^2 \mathrm{Var}(X)</span>.</li>
</ul></li>
</ul>
<section id="wordle-example" class="level4">
<h4 class="anchored" data-anchor-id="wordle-example">Wordle example</h4>
<table class="table">
<colgroup>
<col style="width: 28%">
<col style="width: 24%">
<col style="width: 24%">
<col style="width: 24%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">y=</span>Number of tries</th>
<th style="text-align: center;"><span class="math inline">P(Y=y|\text{Simon})</span></th>
<th style="text-align: center;"><span class="math inline">P(Y=y|\text{Lillie})</span></th>
<th style="text-align: center;"><span class="math inline">y\times P(Y=y|\text{Lillie or Simon})</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td>2</td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td>3</td>
<td style="text-align: center;">0.28</td>
<td style="text-align: center;">0.24</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td>4</td>
<td style="text-align: center;">0.40</td>
<td style="text-align: center;">0.44</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td>5</td>
<td style="text-align: center;">0.18</td>
<td style="text-align: center;">0.19</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td>6</td>
<td style="text-align: center;">0.11</td>
<td style="text-align: center;">0.08</td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</section>
<section id="z-normalization" class="level4">
<h4 class="anchored" data-anchor-id="z-normalization">Z-normalization</h4>
<ul>
<li>Given what we know about properties of mean and variance, we can standardize random variables</li>
<li>Assume <span class="math inline">\mathbb{E} X =\mu</span> and <span class="math inline">\mathrm{Var}(X) = \sigma^2</span>. What is the mean and variance of? [ (X-)/ ]</li>
<li>This is often applied to data using estimates</li>
</ul>
<p>Conditional probabilities (still using sets and real-world examples) Biomedical data examples: Categorical Example: Probabilities for categorical data Continuous Example: Probabilities for continuous data</p>
</section>
</section>
<section id="jointly-distributed-random-variables" class="level3">
<h3 class="anchored" data-anchor-id="jointly-distributed-random-variables">Jointly distributed random variables</h3>
</section>
</section>
<section id="connecting-data-and-probability-with-a-random-sample" class="level2">
<h2 class="anchored" data-anchor-id="connecting-data-and-probability-with-a-random-sample">Connecting data and probability with a random sample</h2>
<section id="statistics-is-a-way-to-learn-about-the-world-from-a-data-set" class="level3">
<h3 class="anchored" data-anchor-id="statistics-is-a-way-to-learn-about-the-world-from-a-data-set">Statistics is a way to learn about the world from a data set</h3>
<p>For now, let’s work with the question, “What is the proportion of people in the united states who have used alcohol in the last 30 days?”</p>
<ol type="1">
<li>What is my parameter of interest (target parameter)?
<ul>
<li>Descriptively – proportion of people who have used alcohol</li>
<li>Mathematically – call this value <span class="math inline">p</span> unknown value</li>
</ul></li>
<li>What is my population of interest?
<ul>
<li>Descriptively – The United States population</li>
<li>Quantitatively – Theoretical distribution defined by the model below in point 4. <span class="math inline">\text{Be}(p)</span></li>
</ul></li>
<li>What is a data point?
<ul>
<li>An answer from an individual in the population “yes”/“no” to the survey question. Coded as 1/0.</li>
</ul></li>
<li>What model can I use to describe how I get a data point?
<ul>
<li>Most obvious one is <span class="math inline">X_i \sim \text{Be}(p)</span>, where <span class="math inline">p</span> is the parameter in point 1.</li>
</ul></li>
</ol>
</section>
<section id="a-random-sample-for-the-alcohol-question" class="level3">
<h3 class="anchored" data-anchor-id="a-random-sample-for-the-alcohol-question">A random sample for the alcohol question</h3>
<ul>
<li>A random sample is a collection of independent random variables that represent potential data points.</li>
<li>Let <span class="math inline">X_i \sim \text{Be}(p)</span> for <span class="math inline">i=1,\ldots, n</span>.</li>
<li>Our assumption about the population the <span class="math inline">X_i</span> are drawn from connects the random sample to the parameter of interest.</li>
<li>Our dataset is assumed to be a single realization of the process we are assuming.</li>
</ul>
<section id="example" class="level4">
<h4 class="anchored" data-anchor-id="example">Example</h4>
</section>
</section>
</section>
<section id="estimates" class="level2">
<h2 class="anchored" data-anchor-id="estimates">Estimates</h2>
<p>Note, an <strong>estimate</strong> is a function of the observed sample and it is nonrandom (Why is it non random?). We often use lowercase letters to make that clear [ x = n^{-1} _{i=1}^n x_i. ]</p>
</section>
<section id="estimators" class="level2">
<h2 class="anchored" data-anchor-id="estimators">Estimators</h2>
<p>An <strong>estimator</strong> is a function of a random sample. The goal (usually) is to estimate a parameter of interest (here, <span class="math inline">p</span>). Let’s consider the estimator [ p = X = n^{-1} _{i=1}^n X_i, ] which we know is pretty reasonable since <span class="math inline">\E \bar X = p</span>.</p>
<ul>
<li>We can study the properties of estimators to learn about how they behave.</li>
<li>If we like an estimator we can compute an estimate using our sample.</li>
<li>We can use features of our estimator to make probabilistic statements about what might happen if we repeat our study. <strong>Dataset-to-dataset variability</strong></li>
</ul>
</section>
<section id="bias-variance-and-mse-of-the-proportion-estimator" class="level2">
<h2 class="anchored" data-anchor-id="bias-variance-and-mse-of-the-proportion-estimator">Bias, variance, and MSE of the proportion estimator</h2>
<ul>
<li>The bias of the proportion estimator (used to estimate the proportion of people who regularly drink alcohol) is: [ ( p - p) = 0 ]</li>
<li>The variance of the estimator is [ <span class="math display">\begin{align*}
\text{Var}(\hat p)
&amp; = n^{-2} \sum_{i=1}^n\text{Var}(X_i) \\
&amp; = n^{-1} p(1-p)
\end{align*}</span> ]</li>
<li>The MSE is the same as the variance since <span class="math inline">\hat p</span> is unbiased.</li>
</ul>
<p>We will come back to this example to construct confidence intervals in the next lecture.</p>
</section>
<section id="nsduh-example-of-bias-variance-and-mse" class="level2">
<h2 class="anchored" data-anchor-id="nsduh-example-of-bias-variance-and-mse">NSDUH: example of bias, variance, and MSE</h2>
<ul>
<li>In NSDUH data</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>puf <span class="ot">=</span> <span class="fu">readRDS</span>(<span class="st">'nsduh/puf.rds'</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">mean</span>(puf<span class="sc">$</span>alcmon<span class="sc">==</span><span class="st">'yes'</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Show what Bias and Variance mean in NSDUH data using simulations</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>nstudies <span class="ot">=</span> <span class="dv">100000</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>phats <span class="ot">=</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nstudies)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(study <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nstudies){</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># random sample</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="at">n =</span> n, <span class="at">prob =</span> p, <span class="at">size=</span><span class="dv">1</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># estimate phat</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  phats[study] <span class="ot">=</span> <span class="fu">mean</span>(x)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co"># mean of phat across the simulations</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(phats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4514003</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(phats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="class2_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="288"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># variance of phat across the simulations</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(phats) <span class="co"># for n=100 this was 0.002527289</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0002474907</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># what the variance should be equal to</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">/</span>n</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0002476392</code></pre>
</div>
</div>
</section>
<section id="parameters-estimators-estimates" class="level2">
<h2 class="anchored" data-anchor-id="parameters-estimators-estimates">Parameters, Estimators, Estimates</h2>
<p>To reiterate:</p>
<ul>
<li><strong>Parameter</strong> – Target unknown feature of a population (nonrandom)</li>
<li><strong>Estimate</strong> – Value computed from observed data to approximate the parameter (nonrandom)</li>
<li><strong>Estimator</strong> – A function of a random sample to approximate the parameter</li>
</ul>
<p>In statistics, probability is used to define and describe the behavior of estimators.</p>
</section>
<section id="practice" class="level2">
<h2 class="anchored" data-anchor-id="practice">Practice</h2>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>