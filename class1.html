<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Simon Vandekar">

<title>Class 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="class1_files/libs/clipboard/clipboard.min.js"></script>
<script src="class1_files/libs/quarto-html/quarto.js"></script>
<script src="class1_files/libs/quarto-html/popper.min.js"></script>
<script src="class1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="class1_files/libs/quarto-html/anchor.min.js"></script>
<link href="class1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="class1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="class1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="class1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="class1_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<link href="class1_files/libs/table1-1.0/table1_defaults.css" rel="stylesheet">

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#objectives" id="toc-objectives" class="nav-link active" data-scroll-target="#objectives">Objectives:</a></li>
  <li><a href="#introductions-15-min" id="toc-introductions-15-min" class="nav-link" data-scroll-target="#introductions-15-min">Introductions (15 min)</a>
  <ul class="collapse">
  <li><a href="#info-about-you" id="toc-info-about-you" class="nav-link" data-scroll-target="#info-about-you">Info about you</a></li>
  <li><a href="#goals-for-this-course" id="toc-goals-for-this-course" class="nav-link" data-scroll-target="#goals-for-this-course">Goals for this course</a></li>
  </ul></li>
  <li><a href="#demonstrating-some-statistical-concepts-20-min" id="toc-demonstrating-some-statistical-concepts-20-min" class="nav-link" data-scroll-target="#demonstrating-some-statistical-concepts-20-min">Demonstrating some statistical concepts (20 min)</a>
  <ul class="collapse">
  <li><a href="#abraham-wald-damaged-bomber-planes" id="toc-abraham-wald-damaged-bomber-planes" class="nav-link" data-scroll-target="#abraham-wald-damaged-bomber-planes">Abraham Wald damaged bomber planes</a></li>
  <li><a href="#monty-hall-problem" id="toc-monty-hall-problem" class="nav-link" data-scroll-target="#monty-hall-problem">Monty hall problem</a></li>
  <li><a href="#bayesian-flipping-probabilities-leading-to-unintuitive-results." id="toc-bayesian-flipping-probabilities-leading-to-unintuitive-results." class="nav-link" data-scroll-target="#bayesian-flipping-probabilities-leading-to-unintuitive-results.">Bayesian flipping probabilities leading to unintuitive results.</a></li>
  <li><a href="#regression-to-the-mean" id="toc-regression-to-the-mean" class="nav-link" data-scroll-target="#regression-to-the-mean">Regression to the mean</a></li>
  </ul></li>
  <li><a href="#statistics-in-medical-research-biostatistics-skipped-this-section-2023" id="toc-statistics-in-medical-research-biostatistics-skipped-this-section-2023" class="nav-link" data-scroll-target="#statistics-in-medical-research-biostatistics-skipped-this-section-2023">Statistics in medical research (Biostatistics) (SKIPPED THIS SECTION 2023)</a>
  <ul class="collapse">
  <li><a href="#example-circularity-analysis" id="toc-example-circularity-analysis" class="nav-link" data-scroll-target="#example-circularity-analysis">Example: Circularity analysis</a></li>
  </ul></li>
  <li><a href="#learning-about-data-estimating-valuesstatistics" id="toc-learning-about-data-estimating-valuesstatistics" class="nav-link" data-scroll-target="#learning-about-data-estimating-valuesstatistics">Learning about data (estimating values/statistics)</a>
  <ul class="collapse">
  <li><a href="#descriptive-statistics-and-their-uses" id="toc-descriptive-statistics-and-their-uses" class="nav-link" data-scroll-target="#descriptive-statistics-and-their-uses">Descriptive statistics and their uses</a></li>
  </ul></li>
  <li><a href="#basic-univariate-visualizations" id="toc-basic-univariate-visualizations" class="nav-link" data-scroll-target="#basic-univariate-visualizations">Basic univariate visualizations</a>
  <ul class="collapse">
  <li><a href="#basic-bivariate-visualizations" id="toc-basic-bivariate-visualizations" class="nav-link" data-scroll-target="#basic-bivariate-visualizations">Basic bivariate visualizations</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Class 1</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Simon Vandekar </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">Objectives:</h2>
<ol type="1">
<li>Introductions</li>
<li>Understand the importance of statistical/probabilistic reasoning</li>
<li>Understand use of statistics in medical research</li>
<li>Learn to summarize data with descriptive statistics</li>
</ol>
</section>
<section id="introductions-15-min" class="level2">
<h2 class="anchored" data-anchor-id="introductions-15-min">Introductions (15 min)</h2>
<section id="info-about-you" class="level3">
<h3 class="anchored" data-anchor-id="info-about-you">Info about you</h3>
<p>Let’s spend some time learning about the other people in the class.</p>
<ol type="1">
<li>What is your math/probability/statistics course experience?</li>
<li>What are your current academic year and school?</li>
<li>Why interested in Biostatistics?</li>
<li>What are your other interests, academic and/or fun?</li>
<li>What are your internship projects?</li>
</ol>
<ul>
<li>Who are you working with?</li>
<li>What are you working on?</li>
</ul>
</section>
<section id="goals-for-this-course" class="level3">
<h3 class="anchored" data-anchor-id="goals-for-this-course">Goals for this course</h3>
<ol type="1">
<li>Foster your interest in Biostatistics for graduate school.</li>
<li>Help you prepare for post-graduation (hopefully for grad school in Biostatistics 🙂).</li>
<li>Build diversity in the field of Biostatistics <a href="https://journals.sagepub.com/doi/10.1177/00333549221097653">Goodman et al.&nbsp;2022</a>.</li>
<li>Teach you to think like a Biostatistician!</li>
</ol>
<!-- | Race and ethnicity      | Graduating biostatistics students | General population | -->
<!-- | ----------- | ----------- |----------- | -->
<!-- | American Indian     | 0%       | -->
<!-- | Asian   | 15.5%     | -->
<!-- | Hispanic   |   7.3%     | -->
<!-- | Native Hawaiian   | 0%       | -->
<!-- | Non-Hispanic Black or African American   | 3.6%        | -->
<!-- | Non-Hispanic White   | 29.1%        | -->
<!-- | Unknown | 44.5% | -->
</section>
</section>
<section id="demonstrating-some-statistical-concepts-20-min" class="level2">
<h2 class="anchored" data-anchor-id="demonstrating-some-statistical-concepts-20-min">Demonstrating some statistical concepts (20 min)</h2>
<section id="abraham-wald-damaged-bomber-planes" class="level3">
<h3 class="anchored" data-anchor-id="abraham-wald-damaged-bomber-planes">Abraham Wald damaged bomber planes</h3>
<p><img src="figures/Survivorship-bias.svg" class="img-fluid" alt="Bomber plane damage"> Image credit: <a href="https://en.wikipedia.org/wiki/Survivorship_bias">Wikipedia</a></p>
<ul>
<li>During World War 2, Abraham Wald was asked to examine damage done to aircraft returning to base and recommend what areas to reinforce with more armor. What are the most important areas to reinforce?</li>
<li>This is an example of <a href="https://en.wikipedia.org/wiki/Survivorship_bias">Survivorship bias</a>.</li>
<li>It is a type of <em>selection bias</em> that can occur in biomedical research if participants with a particular exposure or characteristics are less likely to enroll in a study <a href="https://pubmed.ncbi.nlm.nih.gov/8624068/">Glesby and Hoover, 1996</a>.</li>
</ul>
</section>
<section id="monty-hall-problem" class="level3">
<h3 class="anchored" data-anchor-id="monty-hall-problem">Monty hall problem</h3>
<ul>
<li>Named after the Monty Hall host of a TV show where a similar game happened.</li>
<li>The result is strongly counter-intuitive.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/Monty_open_door.svg" class="img-fluid figure-img" style="width:70.0%"></p>
<p></p><figcaption class="figure-caption">Monty Hall Problem</figcaption><p></p>
</figure>
</div>
<blockquote class="blockquote">
<p>‘Suppose you’re on a game show, and you’re given the choice of three doors: Behind one door is a car; behind the others, goats. You pick a door, say No.&nbsp;1, and the host, who knows what’s behind the doors, opens another door, say No.&nbsp;3, which has a goat. He then says to you, “Do you want to pick door No.&nbsp;2?” Is it to your advantage to switch your choice?’</p>
</blockquote>
<p>Credit: <a href="https://en.wikipedia.org/wiki/Monty_Hall_problem">Wikipedia</a></p>
<ul>
<li>What is the probability of choosing the car the first pick?</li>
<li>What is the probability of choosing a goat the first pick?</li>
<li>Imagine an extreme example: what if there were 50 doors, one car, and Monty Hall opened 48 doors?</li>
<li>It became famous from columnist <a href="https://en.wikipedia.org/wiki/Marilyn_vos_Savant">Marilyn vos Savant</a>, who had a world-record IQ and correctly answered the question in <em>Parade</em> magazine.
<ul>
<li>Over 10,000 readers wrote-in saying she was wrong.</li>
<li>Almost 1,000 of those readers had PhDs.</li>
</ul></li>
<li>This problem relates to <span class="math inline">p</span>-values and multiple hypothesis testing in Biostatistics.</li>
</ul>
</section>
<section id="bayesian-flipping-probabilities-leading-to-unintuitive-results." class="level3">
<h3 class="anchored" data-anchor-id="bayesian-flipping-probabilities-leading-to-unintuitive-results.">Bayesian flipping probabilities leading to unintuitive results.</h3>
<p>Dog COVID example</p>
</section>
<section id="regression-to-the-mean" class="level3">
<h3 class="anchored" data-anchor-id="regression-to-the-mean">Regression to the mean</h3>
<ul>
<li>Regression to the mean comes up a lot in sports <a href="https://towardsdatascience.com/regression-to-the-mean-and-its-implications-648660c9bf76">TDS</a>:</li>
</ul>
<blockquote class="blockquote">
<p>The LA Dodgers, Los Angeles’ resident baseball team, appeared on the cover of Sports Illustratedss August 28, 2017 issue following a run of tremendous form. They had won 71% of their games and were on pace to tie the record for the most wins in a season. The cover came with the caption “Best. Team. Ever?”</p>
</blockquote>
<blockquote class="blockquote">
<p>The team then went on to lose 17 of their next 22 games, and would eventually lose in the World Series to the Houston Astros. This is just one example of the notorious Sports Illustrated cover jinx, an urban legend that apparently causes teams and athletes who appear on the cover to immediately experience a run of bad form.</p>
</blockquote>
<ul>
<li>The phenomenon is due to a combination of selection bias and the amount of randomness inherent in the measurements.</li>
<li>100 people flipping coins example (completely random).</li>
<li>100 people heights example (not very random).</li>
<li>In the baseball example, there are unpredictable factors affecting the teams performance and the team was selected on Sport’s Illustrated’s cover because of their unusually successful performance.</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>firstHalf <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>secondHalf <span class="ot">=</span> (<span class="fu">rnorm</span>(<span class="dv">100</span>) <span class="sc">+</span> firstHalf)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>firstHalf <span class="ot">=</span> <span class="fu">pnorm</span>(firstHalf)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>secondHalf <span class="ot">=</span> <span class="fu">pnorm</span>(secondHalf)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>colinds <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>colinds[<span class="fu">which.max</span>(firstHalf)] <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(firstHalf, secondHalf, <span class="at">main =</span> <span class="st">'Baseball performance, rho=1/2'</span>, <span class="at">ylab=</span><span class="st">'Wins second half'</span>, <span class="at">xlab=</span><span class="st">'Wins first half'</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">col=</span>cols[colinds])</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(secondHalf<span class="sc">~</span> firstHalf), <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>, <span class="at">b=</span><span class="dv">1</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>firstHalf <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>secondHalf <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>firstHalf <span class="ot">=</span> <span class="fu">pnorm</span>(firstHalf)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>secondHalf <span class="ot">=</span> <span class="fu">pnorm</span>(secondHalf)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>colinds <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>colinds[<span class="fu">which.max</span>(firstHalf)] <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(firstHalf, secondHalf, <span class="at">main =</span> <span class="st">'Baseball performance, rho=0'</span>, <span class="at">ylab=</span><span class="st">'Wins second half'</span>, <span class="at">xlab=</span><span class="st">'Wins first half'</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">col=</span>cols[colinds])</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(secondHalf<span class="sc">~</span> firstHalf), <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>, <span class="at">b=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="class1_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="576"></p>
</div>
</div>
</section>
</section>
<section id="statistics-in-medical-research-biostatistics-skipped-this-section-2023" class="level2">
<h2 class="anchored" data-anchor-id="statistics-in-medical-research-biostatistics-skipped-this-section-2023">Statistics in medical research (Biostatistics) (SKIPPED THIS SECTION 2023)</h2>
<p><strong>Features of Biostatistics medical research</strong> * Improving health and understanding biological mechanisms * Prediction/diagnosis clinical translation (often with machine learning) * Collaboration on team with MDs, biologists, psychologists, epidemiologists, informaticians, etc. * Developing new statistical tools to address challenges in medical research!</p>
<p><strong>Biostatisticians’ role on the research team</strong> * It is easy to fit statistical or machine learning models to data and get results. * It is difficult to understand how study design or analysis procedures may bias the results. * Organizing study results in a sensible structure. * Biostatistics offers tools necessary to reason through and understand the analysis procedures.</p>
<section id="example-circularity-analysis" class="level3">
<h3 class="anchored" data-anchor-id="example-circularity-analysis">Example: Circularity analysis</h3>
<ul>
<li>Circularity analysis is a <strong>bad</strong> practice where the same data are used for variable selection and for prediction.</li>
<li>Circularity analysis remains a challenge in brain imaging studies <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2949251/">Kriegeskorte et al., 2010</a></li>
</ul>
<p>A circular analysis: * Let’s say I have measurements of brain activity across 100 brain regions and I want to know, which are associated with diagnosis (e.g.&nbsp;bipolar disorder) and to predict diagnosis using the brain imaging data * First, I fit a bunch of models to select important features</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">555</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>nregions <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">50</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>brain <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="fu">rgamma</span>(n <span class="sc">*</span> nregions, <span class="at">shape =</span> <span class="dv">10</span>, <span class="at">scale=</span><span class="fl">0.1</span>), <span class="at">ncol=</span><span class="dv">100</span>))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(brain) <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">'region'</span>, <span class="dv">1</span><span class="sc">:</span>nregions)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>diagnosis <span class="ot">=</span> <span class="fu">as.factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'control'</span>, <span class="st">'bipolar'</span>), <span class="at">each=</span><span class="dv">25</span>))</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">10</span>))</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">sapply</span>(<span class="fu">names</span>(brain), <span class="cf">function</span>(y) <span class="fu">plot</span>(diagnosis, brain[,y], <span class="at">ylab=</span><span class="st">'Cortical Thickness'</span>, <span class="at">xlab=</span><span class="st">'Diagnosis'</span>, <span class="at">main=</span>y) ) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="class1_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
<ul>
<li>Based on this curve, we might select the first 5 brain regions to build a prediction model.</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>difference <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">do.call</span>(<span class="st">'-'</span>, <span class="fu">by</span>(brain, diagnosis, colMeans)))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(difference[<span class="fu">order</span>(difference, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)], <span class="at">xaxt=</span><span class="st">'n'</span>, <span class="at">ylab=</span><span class="st">'Mean difference'</span>, <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="fl">2.8</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>), <span class="at">xlab=</span><span class="st">'Region'</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side=</span><span class="dv">1</span>, <span class="at">at=</span><span class="dv">1</span><span class="sc">:</span>nregions, <span class="at">labels =</span> <span class="fu">gsub</span>(<span class="st">'region'</span>, <span class="st">''</span>, <span class="fu">names</span>(difference)[<span class="fu">order</span>(difference, <span class="at">decreasing=</span><span class="cn">TRUE</span>)]) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="class1_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
<ul>
<li>After selecting the features, we can fit a random forest to predict the outcome with our 5 strongest features.</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>randomForest 4.7-1.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Type rfNews() to see new features/changes/bug fixes.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">as.matrix</span>(brain[,<span class="fu">order</span>(difference, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]])</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>rf <span class="ot">=</span> <span class="fu">randomForest</span>(x, <span class="at">y=</span>diagnosis, <span class="at">ntree =</span> <span class="dv">1000</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>rf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(x = x, y = diagnosis, ntree = 1000) 
               Type of random forest: classification
                     Number of trees: 1000
No. of variables tried at each split: 2

        OOB estimate of  error rate: 38%
Confusion matrix:
        bipolar control class.error
bipolar      16       9        0.36
control      10      15        0.40</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(rf<span class="sc">$</span>confusion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">bipolar</th>
<th style="text-align: right;">control</th>
<th style="text-align: right;">class.error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">bipolar</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0.36</td>
</tr>
<tr class="even">
<td style="text-align: left;">control</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0.40</td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(glm(diagnosis ~ x, family=binomial))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>The out-of-sample prediction error is 38%, indicating (100-38)% - 62% accuracy in predicting bipolar disorder from the brain imaging data.</li>
<li>While this accuracy isn’t great, the true accuracy should be 50% (random chance) – all of the data I showed were fake and there was not association.</li>
<li><strong>Circularity analysis</strong> is a common mistake in high-dimensional biomedical data.</li>
<li>Biostatistical concepts help us to describe this error mathematically and understand how use methods to avoid it.</li>
</ul>
</section>
</section>
<section id="learning-about-data-estimating-valuesstatistics" class="level2">
<h2 class="anchored" data-anchor-id="learning-about-data-estimating-valuesstatistics">Learning about data (estimating values/statistics)</h2>
<div class="cell">

</div>
<section id="descriptive-statistics-and-their-uses" class="level3">
<h3 class="anchored" data-anchor-id="descriptive-statistics-and-their-uses">Descriptive statistics and their uses</h3>
<ul>
<li>Descriptive statistics are used to get an idea of what a dataset looks like</li>
<li>In research studies, they are frequently reported in a “Table 1”.</li>
</ul>
<p><img src="figures/table1_muscatello2022.png" class="img-fluid" alt="Table 1 example Muscatello et al.&nbsp;2022"> <a href="https://molecularautism.biomedcentral.com/articles/10.1186/s13229-022-00515-4">Muscatello et al., 2022</a></p>
<p>Commonly reported values are:</p>
<ul>
<li><em>Sample size</em>, usually denoted <span class="math inline">n</span></li>
<li><em>Mean</em> <span class="math inline">\bar x = n^{-1} \sum_{i=1}^n x_i</span>. <em>Proportions</em> are also often reported, which is just the mean of a categorical variable.</li>
<li><em>Variance</em> <span class="math inline">s^2 = (n-1)^{-1} \sum_{i=1}^n (x_i-\bar x)^2</span>.</li>
<li><em>Standard deviation</em> (SD) <span class="math inline">s = \sqrt{s^2}</span> (square root of the variance)</li>
<li><em>Median</em> is the middle value (or the average of the two middle values if <span class="math inline">n</span> is even. the 50% ordered value.</li>
<li><em>Quartiles</em>, the 25% ordered value and 75% ordered value. Some times call <em>Inter quartile range (IQR)</em>.</li>
</ul>
<p>These summary values provide information about what the distribution of data look like.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>nsduh <span class="ot">=</span> <span class="fu">readRDS</span>(<span class="st">'nsduh/puf.rds'</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># age is categorical in this dataset</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>agetab <span class="ot">=</span> <span class="fu">table</span>(nsduh<span class="sc">$</span>age)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># proportions in each age group</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>agetab <span class="ot">=</span> agetab<span class="sc">/</span><span class="fu">sum</span>(agetab)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># quantile(nsduh$age, probs = c(0.5, 0.25, 0.75))</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>agetab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
      12-17       18-25       26-34       35-49 50 or older 
  0.2508392   0.2400830   0.1538042   0.1996766   0.1555970 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of cigarettes in the last 30 days</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mean and standard deviation</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>cigarettes <span class="ot">=</span> <span class="fu">c</span>(<span class="at">mean=</span><span class="fu">mean</span>(nsduh<span class="sc">$</span>ircigfm), <span class="at">SD=</span><span class="fu">sd</span>(nsduh<span class="sc">$</span>ircigfm))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># quantiles</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>qsCig <span class="ot">=</span> <span class="fu">quantile</span>(nsduh<span class="sc">$</span>ircigfm, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.25</span>, <span class="fl">0.75</span>))</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(qsCig)[<span class="dv">1</span>] <span class="ot">=</span> <span class="st">'Median'</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>qsCig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Median    25%    75% 
     0      0      0 </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(table1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'table1'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    units, units&lt;-</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>nsduh<span class="sc">$</span>ERvisit <span class="ot">=</span> <span class="fu">factor</span>(nsduh<span class="sc">$</span>ERvisit, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'no'</span>, <span class="st">'yes'</span>))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(nsduh<span class="sc">$</span>ERvisit) <span class="ot">=</span> <span class="st">'Visited ER'</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(nsduh<span class="sc">$</span>age) <span class="ot">=</span> <span class="st">'Age'</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(nsduh<span class="sc">$</span>ircigfm) <span class="ot">=</span> <span class="st">'No. Cig last 30 days'</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">table1</span>(<span class="sc">~</span> ERvisit <span class="sc">+</span> age <span class="sc">+</span> ircigfm, <span class="at">data=</span>nsduh)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="Rtable1"><table class="Rtable1">
<thead>
<tr>
<th class="rowlabel firstrow lastrow"></th>
<th class="firstrow lastrow"><span class="stratlabel">Overall<br><span class="stratn">(N=56897)</span></span></th>
</tr>
</thead>
<tbody>
<tr>
<td class="rowlabel firstrow">Visited ER</td>
<td class="firstrow"></td>
</tr>
<tr>
<td class="rowlabel">no</td>
<td>39818 (70.0%)</td>
</tr>
<tr>
<td class="rowlabel">yes</td>
<td>15403 (27.1%)</td>
</tr>
<tr>
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">1676 (2.9%)</td>
</tr>
<tr>
<td class="rowlabel firstrow">Age</td>
<td class="firstrow"></td>
</tr>
<tr>
<td class="rowlabel">12-17</td>
<td>14272 (25.1%)</td>
</tr>
<tr>
<td class="rowlabel">18-25</td>
<td>13660 (24.0%)</td>
</tr>
<tr>
<td class="rowlabel">26-34</td>
<td>8751 (15.4%)</td>
</tr>
<tr>
<td class="rowlabel">35-49</td>
<td>11361 (20.0%)</td>
</tr>
<tr>
<td class="rowlabel lastrow">50 or older</td>
<td class="lastrow">8853 (15.6%)</td>
</tr>
<tr>
<td class="rowlabel firstrow">No. Cig last 30 days</td>
<td class="firstrow"></td>
</tr>
<tr>
<td class="rowlabel">Mean (SD)</td>
<td>3.89 (9.53)</td>
</tr>
<tr>
<td class="rowlabel lastrow">Median [Min, Max]</td>
<td class="lastrow">0 [0, 30.0]</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<ul>
<li>Sometimes test statistics and <span class="math inline">p</span>-values are reported as well, that compare values between two or more groups.</li>
</ul>
</section>
</section>
<section id="basic-univariate-visualizations" class="level2">
<h2 class="anchored" data-anchor-id="basic-univariate-visualizations">Basic univariate visualizations</h2>
<section id="histograms" class="level4">
<h4 class="anchored" data-anchor-id="histograms">Histograms</h4>
<ul>
<li>A histogram creates evenly sized bins of the x-axis and plots the number of observations falling into that bin. <span class="math display">
y_k(l_k, u_k) = \sum_{i=1}^n \mathrm{I}(x_i \in [l_k, u_k]),
</span> where <span class="math inline">l_k, u_k</span> are the lower and upper boundaries of bin <span class="math inline">k</span>, respectively.</li>
<li>It is a nice way to summarize continuous variables.</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">as.numeric</span>(nsduh<span class="sc">$</span>ERvisit)<span class="sc">-</span><span class="dv">1</span>, <span class="at">xlab=</span><span class="st">'no/yes'</span>, <span class="at">main=</span><span class="st">'Visited ER'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="class1_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="384"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Can change the number of bins</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(nsduh<span class="sc">$</span>nERvisit, <span class="at">xlab =</span> <span class="st">'No. ER Visits'</span>, <span class="at">main=</span><span class="st">''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="class1_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid" width="384"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(nsduh<span class="sc">$</span>nERvisit, <span class="at">xlab =</span> <span class="st">'No. ER Visits'</span>, <span class="at">main=</span><span class="st">''</span>, <span class="at">breaks =</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="class1_files/figure-html/unnamed-chunk-8-3.png" class="img-fluid" width="384"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(nsduh<span class="sc">$</span>ircigfm, <span class="at">xlab=</span><span class="st">'No. Days'</span>, <span class="at">main=</span><span class="st">'No. Days Smoked'</span>, <span class="at">breaks=</span><span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="class1_files/figure-html/unnamed-chunk-8-4.png" class="img-fluid" width="384"></p>
</div>
</div>
<ul>
<li>This is an example of bi-modal data, where there are two different groups of people.</li>
</ul>
</section>
<section id="density-plots" class="level4">
<h4 class="anchored" data-anchor-id="density-plots">Density plots</h4>
<ul>
<li>Density plots are good alternative visualization for continuous variables</li>
<li>This example from <a href="https://pubmed.ncbi.nlm.nih.gov/34983062/">Harris et al.&nbsp;2022</a> is comparing distributions of single-cell expression data from multiplexed immunofluorescence imaging data.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/harris_densities.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Example of density plots</figcaption><p></p>
</figure>
</div>
</section>
<section id="qq-plots" class="level4">
<h4 class="anchored" data-anchor-id="qq-plots">QQ-plots</h4>
</section>
<section id="basic-bivariate-visualizations" class="level3">
<h3 class="anchored" data-anchor-id="basic-bivariate-visualizations">Basic bivariate visualizations</h3>
<section id="scatter-plot" class="level4">
<h4 class="anchored" data-anchor-id="scatter-plot">Scatter plot</h4>
<ul>
<li>With and without lowess smooth</li>
<li>Scatter plot matrix</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the data </span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nsduh<span class="sc">$</span>ircigage, nsduh<span class="sc">$</span>iralcage, <span class="at">ylab=</span><span class="st">'Age first alc use'</span>, <span class="at">xlab=</span><span class="st">'Age first cig'</span>, <span class="at">main=</span><span class="st">'Cig and Alc Use'</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># remove missing values for lowess fit</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>subset <span class="ot">=</span> <span class="fu">na.omit</span>(nsduh[, <span class="fu">c</span>(<span class="st">'ircigage'</span>, <span class="st">'iralcage'</span>)])</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">lowess</span>( subset<span class="sc">$</span>ircigage, subset<span class="sc">$</span>iralcage), <span class="at">col=</span><span class="st">'blue'</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="class1_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nsduh[,<span class="fu">c</span>(<span class="st">'ircigage'</span>, <span class="st">'iralcage'</span>, <span class="st">'irmjage'</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="class1_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="864"></p>
</div>
</div>
</section>
<section id="box-plot" class="level4">
<h4 class="anchored" data-anchor-id="box-plot">Box plot</h4>
<ul>
<li>Box plot is a visual summary of quantiles of the data, usually stratified by a categorical variable.</li>
<li>Black line is the median, box is the IQR, whiskers are the minimum/maximum excluding “outliers”.
<ul>
<li>Outliers - value is smaller than the lower fence (= 1st quartile - 1.5<em>IQR) or greater than the upper fence (= 3rd quartile + 1.5</em>IQR).</li>
</ul></li>
<li>Many different variations that you can control in <code>R</code> with the <code>boxplot</code> function.</li>
<li>Nice <a href="https://r-coder.com/boxplot-r/#:~:text=ggplot2%20from%20dataframe-,How%20to%20interpret%20a%20box%20plot%20in%20R%3F,inside%20that%20represents%20the%20median.">blog post</a> on variations available in <code>R</code> packages.</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>( nERvisit <span class="sc">~</span> age, <span class="at">data=</span>nsduh, <span class="at">ylab=</span><span class="st">'ER Visits'</span>, <span class="at">main=</span><span class="st">'No. ER Visits by Age'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="class1_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="384"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>( ircigfm <span class="sc">~</span> age, <span class="at">data=</span>nsduh, <span class="at">ylab=</span><span class="st">'No days smoking'</span>, <span class="at">main=</span><span class="st">'Cig by Age'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="class1_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid" width="384"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>( ircigfm <span class="sc">~</span> age, <span class="at">data=</span>nsduh, <span class="at">ylab=</span><span class="st">'No days smoking'</span>, <span class="at">main=</span><span class="st">'Cig by Age'</span>, <span class="at">outline=</span><span class="cn">FALSE</span>, <span class="at">notch=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in (function (z, notch = FALSE, width = NULL, varwidth = FALSE, : some
notches went outside hinges ('box'): maybe set notch=FALSE</code></pre>
</div>
<div class="cell-output-display">
<p><img src="class1_files/figure-html/unnamed-chunk-11-3.png" class="img-fluid" width="384"></p>
</div>
</div>
</section>
<section id="violin-plots" class="level4">
<h4 class="anchored" data-anchor-id="violin-plots">Violin plots</h4>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>